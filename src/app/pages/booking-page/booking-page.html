<div class="booking-page-container my-5">
  <div class="container">
    <div class="row g-5">
      
      <div class="col-lg-7">
        <h2 class="fw-bold mb-4">Your Travel Details</h2>
        <form #bookingForm="ngForm" (ngSubmit)="onSubmitBooking()">
          <div class="row g-4">

            <div class="col-12">
              <label for="destination" class="form-label">Choose Your Destination</label>
              <select class="form-select" 
                      id="destination" 
                      name="destination" 
                      [(ngModel)]="bookingDetails.destinationId"
                      (change)="onDestinationChange()"
                      [disabled]="route.snapshot.paramMap.get('id') !== null"
                      required 
                      #destinationInput="ngModel">
                <option [ngValue]="null" disabled>Select a destination...</option>
                <option *ngFor="let dest of allDestinations" [value]="dest.id">{{ dest.name }}</option>
              </select>
              <div *ngIf="destinationInput.invalid && destinationInput.touched" @fieldErrorAnimation class="form-text text-danger">
                Please select a destination.
              </div>
            </div>

            <div class="col-md-6">
              <label for="fullName" class="form-label">Full Name</label>
              <input type="text" class="form-control" id="fullName" name="fullName" [(ngModel)]="bookingDetails.fullName" required #nameInput="ngModel">
              <div *ngIf="nameInput.invalid && nameInput.touched" @fieldErrorAnimation class="form-text text-danger">
                Full name is required.
              </div>
            </div>
            
            <div class="col-md-6">
              <label for="email" class="form-label">Email Address</label>
              <input type="email" class="form-control" id="email" name="email" [(ngModel)]="bookingDetails.email" required email #emailInput="ngModel">
                <div *ngIf="emailInput.invalid && emailInput.touched" @fieldErrorAnimation class="form-text text-danger">
                Please enter a valid email.
              </div>
            </div>
            
            <div class="col-md-6">
              <label for="phone" class="form-label">Phone Number</label>
              <input type="tel" 
                     class="form-control" 
                     id="phone" 
                     name="phone" 
                     [(ngModel)]="bookingDetails.phone" 
                     required 
                     #phoneInput="ngModel">
              <div *ngIf="phoneInput.invalid && phoneInput.touched" @fieldErrorAnimation class="form-text text-danger">
                Phone number is required.
              </div>
            </div>

            <div class="col-md-6">
              <label for="travelDate" class="form-label">Travel Date</label>
              <input type="date" class="form-control" id="travelDate" name="travelDate" [(ngModel)]="bookingDetails.travelDate" required #dateInput="ngModel">
              <div *ngIf="dateInput.invalid && dateInput.touched" @fieldErrorAnimation class="form-text text-danger">
                Travel date is required.
              </div>
            </div>

            <div class="col-12">
              <label for="travelers" class="form-label">Number of Travelers</label>
              <input type="number" class="form-control" id="travelers" name="travelers" min="1" 
                     [(ngModel)]="bookingDetails.travelers"
                     (input)="calculatePrice()"
                     required>
            </div>
            
            <div class="col-12">
              <label for="requests" class="form-label">Special Requests <span class="text-muted">(Optional)</span></label>
              <textarea class="form-control" id="requests" name="requests" rows="3" [(ngModel)]="bookingDetails.requests"></textarea>
            </div>
            
            <div class="col-12 mt-4">
              <button type="submit" class="btn btn-primary w-100 btn-lg">Confirm Booking</button>
            </div>
          </div>
        </form>
      </div>

      <div class="col-lg-5">
        <div class="summary-card p-4">
          <h4 class="fw-bold mb-4">Booking Summary</h4>
          <div *ngIf="selectedDestination; else noSelection">
            <img [src]="selectedDestination.image" class="img-fluid rounded mb-3" [alt]="selectedDestination.name">
            <h5 class="fw-bold">{{ selectedDestination.name }}</h5>
            <p class="text-muted">{{ selectedDestination.location }}</p>
            <hr>
            <div class="d-flex justify-content-between">
              <span>Price per person</span>
              <strong>{{ selectedDestination.price | currency:'INR' }}</strong>
            </div>
            <div class="d-flex justify-content-between">
              <span>Travelers</span>
              <strong>x {{ bookingDetails.travelers }}</strong>
            </div>
            <hr>
            <div class="d-flex justify-content-between align-items-center total">
              <span class="fw-bold">Total</span>
              <strong class="fs-4 text-primary">{{ totalPrice | currency:'INR' }}</strong>
            </div>
          </div>
          <ng-template #noSelection>
            <div class="text-center p-5">
              <i class="bi bi-geo-alt display-3 text-muted"></i>
              <p class="mt-3 text-muted">Select a destination to see your summary.</p>
            </div>
          </ng-template>
        </div>
      </div>

    </div>
  </div>
</div>
